<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="유튜브 동영상 검색 및 엑셀 저장 도구 - 검색어, 채널, 날짜별로 유튜브 동영상을 검색하고 엑셀로 다운로드하세요.">
    <title>YouTube Search Pro - 유튜브 검색 & 엑셀 저장</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- SheetJS for Excel export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>

    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- 배경 장식 요소 -->
    <div class="bg-decoration">
        <div class="bg-orb bg-orb-1"></div>
        <div class="bg-orb bg-orb-2"></div>
        <div class="bg-orb bg-orb-3"></div>
    </div>

    <!-- 헤더 -->
    <header class="header" id="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
                        <path
                            d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814z"
                            fill="#FF0000" />
                        <path d="M9.545 15.568V8.432L15.818 12l-6.273 3.568z" fill="#fff" />
                    </svg>
                </div>
                <h1 class="logo-text">YouTube Search Pro</h1>
            </div>
            <p class="header-subtitle">유튜브 동영상 검색 & 엑셀 저장 도구</p>
        </div>
    </header>

    <!-- 메인 컨텐츠 -->
    <main class="main-content">
        <!-- 검색 패널 -->
        <section class="search-panel glass-card" id="searchPanel">
            <div class="panel-header">
                <h2 class="panel-title">
                    <span class="panel-icon">🔍</span>
                    검색 조건 설정
                </h2>
            </div>

            <form id="searchForm" class="search-form" onsubmit="return false;">
                <!-- API 키 상태 표시 -->
                <div class="api-key-status" id="apiKeyStatus">
                    <span class="api-status-icon" id="apiStatusIcon">🔑</span>
                    <span class="api-status-text" id="apiStatusText">API 키 확인 중...</span>
                    <span class="api-status-hint">config.js 파일에서 설정됨</span>
                </div>

                <div class="form-row">
                    <!-- 검색어 -->
                    <div class="form-group" id="searchQueryGroup">
                        <label class="form-label" for="searchQuery">
                            <span class="label-icon">📝</span>
                            검색어
                            <span class="optional-badge">선택</span>
                        </label>
                        <input type="text" id="searchQuery" class="form-input" placeholder="예: 파이썬 강좌, AI 뉴스">
                    </div>

                    <!-- 채널 ID -->
                    <div class="form-group" id="channelIdGroup">
                        <label class="form-label" for="channelId">
                            <span class="label-icon">📺</span>
                            채널 ID
                            <span class="optional-badge">선택</span>
                        </label>
                        <input type="text" id="channelId" class="form-input" placeholder="예: UCxxxxxxxxxxxxxx">
                    </div>
                </div>

                <p class="form-notice">※ 검색어와 채널 ID 중 하나 이상은 반드시 입력해야 합니다.</p>

                <div class="form-row">
                    <!-- 시작 날짜 -->
                    <div class="form-group" id="startDateGroup">
                        <label class="form-label" for="startDate">
                            <span class="label-icon">📅</span>
                            시작 날짜
                            <span class="optional-badge">선택</span>
                        </label>
                        <input type="date" id="startDate" class="form-input">
                    </div>

                    <!-- 종료 날짜 -->
                    <div class="form-group" id="endDateGroup">
                        <label class="form-label" for="endDate">
                            <span class="label-icon">📅</span>
                            종료 날짜
                            <span class="optional-badge">선택</span>
                        </label>
                        <input type="date" id="endDate" class="form-input">
                    </div>

                    <!-- 파일명 -->
                    <div class="form-group" id="fileNameGroup">
                        <label class="form-label" for="fileName">
                            <span class="label-icon">📄</span>
                            엑셀 파일명
                            <span class="optional-badge">선택</span>
                        </label>
                        <input type="text" id="fileName" class="form-input" placeholder="youtube_results"
                            value="youtube_results">
                        <span class="form-hint">확장자(.xlsx)는 자동으로 추가됩니다</span>
                    </div>
                </div>

                <!-- 검색 버튼 -->
                <div class="form-actions">
                    <button type="button" id="searchBtn" class="btn btn-primary" onclick="startSearch()">
                        <span class="btn-icon">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2.5">
                                <circle cx="11" cy="11" r="8" />
                                <line x1="21" y1="21" x2="16.65" y2="16.65" />
                            </svg>
                        </span>
                        <span class="btn-text">검색 시작</span>
                        <span class="btn-loader" id="searchLoader" style="display:none;">
                            <span class="spinner"></span>
                        </span>
                    </button>
                </div>
            </form>
        </section>

        <!-- 로그 패널 -->
        <section class="log-panel glass-card" id="logPanel" style="display:none;">
            <div class="panel-header">
                <h2 class="panel-title">
                    <span class="panel-icon">📋</span>
                    진행 상황
                </h2>
                <button type="button" class="btn btn-ghost btn-sm" onclick="clearLog()" id="clearLogBtn">
                    로그 지우기
                </button>
            </div>
            <div class="log-container" id="logContainer">
                <div class="log-content" id="logContent"></div>
            </div>
        </section>

        <!-- 통계 카드 -->
        <section class="stats-section" id="statsSection" style="display:none;">
            <div class="stats-grid">
                <div class="stat-card glass-card" id="statTotal">
                    <div class="stat-icon">🎬</div>
                    <div class="stat-info">
                        <span class="stat-value" id="statTotalValue">0</span>
                        <span class="stat-label">검색된 동영상</span>
                    </div>
                </div>
                <div class="stat-card glass-card" id="statViews">
                    <div class="stat-icon">👁️</div>
                    <div class="stat-info">
                        <span class="stat-value" id="statViewsValue">0</span>
                        <span class="stat-label">총 조회수</span>
                    </div>
                </div>
                <div class="stat-card glass-card" id="statComments">
                    <div class="stat-icon">💬</div>
                    <div class="stat-info">
                        <span class="stat-value" id="statCommentsValue">0</span>
                        <span class="stat-label">총 댓글수</span>
                    </div>
                </div>
                <div class="stat-card glass-card" id="statAvgViews">
                    <div class="stat-icon">📊</div>
                    <div class="stat-info">
                        <span class="stat-value" id="statAvgViewsValue">0</span>
                        <span class="stat-label">평균 조회수</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- 결과 테이블 -->
        <section class="results-panel glass-card" id="resultsPanel" style="display:none;">
            <div class="panel-header">
                <h2 class="panel-title">
                    <span class="panel-icon">📊</span>
                    검색 결과
                    <span class="result-count" id="resultCount"></span>
                </h2>
                <button type="button" class="btn btn-success" onclick="downloadExcel()" id="downloadBtn">
                    <span class="btn-icon">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2.5">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="7 10 12 15 17 10" />
                            <line x1="12" y1="15" x2="12" y2="3" />
                        </svg>
                    </span>
                    엑셀 다운로드
                </button>
            </div>

            <div class="table-wrapper" id="tableWrapper">
                <table class="results-table" id="resultsTable">
                    <thead>
                        <tr>
                            <th class="th-index">#</th>
                            <th class="th-thumbnail">썸네일</th>
                            <th class="th-title">제목</th>
                            <th class="th-channel">채널</th>
                            <th class="th-duration">재생시간</th>
                            <th class="th-views">조회수</th>
                            <th class="th-comments">댓글수</th>
                            <th class="th-date">업로드일</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody"></tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- 푸터 -->
    <footer class="footer">
        <p>YouTube Search Pro &copy; 2026 | YouTube Data API v3 활용</p>
    </footer>

    <script src="config.js"></script>
    <script src="app.js"></script>
</body>

</html>